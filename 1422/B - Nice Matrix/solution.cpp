#include<bits/stdc++.h>using namespace std;typedef long long ll;void f(ll n,vector<ll>&a){    for(ll i=0;i<n;i++)cin>>a[i];}ll pick (vector<ll>&temp){    sort(begin(temp),end(temp));    ll o1=0,o2=0;    for (ll i = 0; i < 4; i++)    {        o1+=(abs(temp[1]-temp[i]));        o2+=(abs(temp[2]-temp[i]));    }    return min(o1,o2);}void solve(){    ll n,m;    cin>>n>>m;    vector<vector<ll>>grid(n,vector<ll>(m));    for (ll i = 0; i < n; i++)       for (ll j = 0;  j < m; j++)cin>>grid[i][j];        ll res=0;    for (ll i = 0; i < n/2; i++)    {        for (ll j = 0; j < m/2; j++)        {            vector<ll>temp;            temp.push_back(grid[i][j]);            temp.push_back(grid[i][m-j-1]);            temp.push_back(grid[n-i-1][j]);            temp.push_back(grid[n-i-1][m-j-1]);            res+=pick(temp);        }    }if (n & 1) {    int row = n / 2;    for (int j = 0; j < m / 2; j++) {        res += abs(grid[row][j] - grid[row][m - j - 1]);    }} if (m & 1) {    int col = m / 2;    for (int i = 0; i < n / 2; i++) {        res += abs(grid[i][col] - grid[n - i - 1][col]);    }}     cout<<res<<'\n'; } int main(){ll t;cin>>t;while (t--){    solve();}     return 0;}