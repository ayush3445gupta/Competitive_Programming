<h3><a href="https://codeforces.com/contest/1741/problem/D" target="_blank" rel="noopener noreferrer">Masha and a Beautiful Tree</a></h3>

<div class="header"><div class="title">D. Masha and a Beautiful Tree</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p>The girl named Masha was walking in the forest and found a complete binary tree of height $$$n$$$ and a permutation $$$p$$$ of length $$$m=2^n$$$.</p><p>A complete binary tree of height $$$n$$$ is a rooted tree such that every vertex except the leaves has exactly two sons, and the length of the path from the root to any of the leaves is $$$n$$$. The picture below shows the complete binary tree for $$$n=2$$$.</p><p>A permutation is an array consisting of $$$n$$$ different integers from $$$1$$$ to $$$n$$$. For example, [$$$2,3,1,5,4$$$] is a permutation, but [$$$1,2,2$$$] is not ($$$2$$$ occurs twice), and [$$$1,3,4$$$] is also not a permutation ($$$n=3$$$, but there is $$$4$$$ in the array).</p><p>Let's enumerate $$$m$$$ leaves of this tree from left to right. The leaf with the number $$$i$$$ contains the value $$$p_i$$$ ($$$1 \le i \le m$$$).</p><p>For example, if $$$n = 2$$$, $$$p = [3, 1, 4, 2]$$$, the tree will look like this:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/52db4e69d135641644f7a657f3efed8e31f17ffe.png" style="max-width: 100.0%;max-height: 100.0%;"> </center><p>Masha considers a tree <span class="tex-font-style-it">beautiful</span> if the values in its leaves are ordered from left to right in increasing order.</p><p>In one operation, Masha can choose any non-leaf vertex of the tree and swap its left and right sons (along with their subtrees).</p><p>For example, if Masha applies this operation to the root of the tree discussed above, it will take the following form:</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/f79f1fccffc3b9829ffebebc98441c077f76e010.png" style="max-width: 100.0%;max-height: 100.0%;"> </center><p>Help Masha understand if she can make a tree <span class="tex-font-style-it">beautiful</span> in a certain number of operations. If she can, then output the minimum number of operations to make the tree <span class="tex-font-style-it">beautiful</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains single integer $$$t$$$ ($$$1 \le t \le 10^4$$$) — number of test cases.</p><p>In each test case, the first line contains an integer $$$m$$$ ($$$1 \le m \le 262144$$$), which is a power of two  — the size of the permutation $$$p$$$.</p><p>The second line contains $$$m$$$ integers: $$$p_1, p_2, \dots, p_m$$$ ($$$1 \le p_i \le m$$$) — the permutation $$$p$$$.</p><p>It is guaranteed that the sum of $$$m$$$ over all test cases does not exceed $$$3 \cdot 10^5$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case in a separate line, print the minimum possible number of operations for which Masha will be able to make the tree <span class="tex-font-style-it">beautiful</span> or <span class="tex-font-style-tt">-1</span>, if this is not possible.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id003326510830307664" id="id005353117440202725" class="input-output-copier">Copy</div></div><pre id="id003326510830307664"><div class="test-example-line test-example-line-even test-example-line-0">4</div><div class="test-example-line test-example-line-odd test-example-line-1">8</div><div class="test-example-line test-example-line-odd test-example-line-1">6 5 7 8 4 3 1 2</div><div class="test-example-line test-example-line-even test-example-line-2">4</div><div class="test-example-line test-example-line-even test-example-line-2">3 1 4 2</div><div class="test-example-line test-example-line-odd test-example-line-3">1</div><div class="test-example-line test-example-line-odd test-example-line-3">1</div><div class="test-example-line test-example-line-even test-example-line-4">8</div><div class="test-example-line test-example-line-even test-example-line-4">7 8 4 3 1 2 6 5</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id0028567654872467174" id="id008036462131777565" class="input-output-copier">Copy</div></div><pre id="id0028567654872467174">4
-1
0
-1
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Consider the first test.</p><p>In the first test case, you can act like this (the vertex to which the operation is applied at the current step is highlighted in purple): </p><center> <table class="tex-tabular bordertable"><tbody><tr><td class="tex-tabular-text-align-center"><img class="tex-graphics" src="https://espresso.codeforces.com/a02edad53289724d1cb8ffc75390d49892561b55.png" style="max-width: 100.0%;max-height: 100.0%;"></td><td class="tex-tabular-text-align-center"><img class="tex-graphics" src="https://espresso.codeforces.com/83eaacfa78a5cf9f9e4abe78b6da9f678d2b1ab3.png" style="max-width: 100.0%;max-height: 100.0%;"></td></tr><tr><td class="tex-tabular-text-align-center"><img class="tex-graphics" src="https://espresso.codeforces.com/f42c011add6978d56b1a7f59441b4b9e4f8c3cf1.png" style="max-width: 100.0%;max-height: 100.0%;"></td><td class="tex-tabular-text-align-center"><img class="tex-graphics" src="https://espresso.codeforces.com/b0e374a1e2c83a14496a54d80054976fff43f008.png" style="max-width: 100.0%;max-height: 100.0%;"></td></tr></tbody></table> </center> It can be shown that it is impossible to make a tree <span class="tex-font-style-it">beautiful</span> in fewer operations.<p>In the second test case, it can be shown that it is impossible to make a tree <span class="tex-font-style-it">beautiful</span>.</p><p>In the third test case, the tree is already <span class="tex-font-style-it">beautiful</span>.</p></div>