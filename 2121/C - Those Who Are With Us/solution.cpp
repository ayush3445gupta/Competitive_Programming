#include<bits/stdc++.h>using namespace std;typedef long long ll;void f(ll n,vector<ll>&a){    for(ll i=0;i<n;i++)cin>>a[i];} void solve(){    ll n,m;    cin>>n>>m;    vector<vector<ll>>arr(n,vector<ll>(m));    ll mx=0,cnt_mx=0;    for (ll i = 0; i < n; i++)        for (ll j = 0; j < m; j++){            cin>>arr[i][j];            if(arr[i][j]>mx){                mx=arr[i][j],cnt_mx=1;            }            else if (arr[i][j]==mx)cnt_mx++;        }        vector<ll>row(n),col(m);    for (ll i = 0; i < n; i++)    {        for (ll j = 0; j < m; j++)        {            if(arr[i][j]==mx){                row[i]++,col[j]++;            }        }    }    bool f=0;    for (ll i = 0; i < n; i++)    {        for (ll j = 0; j < m; j++)        {           if(row[i]+col[j]-(arr[i][j]==mx)==cnt_mx)f=1;        }            }        if(f)cout<<mx-1<<'\n';    else cout<<mx<<'\n';} int main(){ll t;cin>>t;while (t--){    solve();}     return 0;}