#include<bits/stdc++.h>using namespace std;typedef long long ll;void solve(){    ll n,k;    cin>>n>>k;    vector<pair<ll,ll>>vec(n);    for (ll i = 0; i < n; i++)    {        cin>>vec[i].first;        vec[i].second=i;    }    sort(begin(vec),end(vec));    ll ans=n;    ll i=0;    while(i<n)    {        ll j=i,prev=-1;        ll mx=0,smx=0;        while (j<n && vec[j].first==vec[i].first)        {            ll gap=vec[j].second-1-prev;            if(gap>=mx){                smx=mx;                mx=gap;            }            else if (gap>smx)smx=gap;                        prev=vec[j].second;            j++;        }         ll gap=(n-1-prev);        if(gap>=mx){            smx=mx;            mx=gap;        }        else if (gap>smx)smx=gap;        ll best=max(smx,mx/2);        ans=min(ans,best);        i=j;    }     cout<<ans<<'\n';  } int main(){ll t;cin>>t;while (t--){    solve();}     return 0;}