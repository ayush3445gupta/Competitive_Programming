#include<bits/stdc++.h>using namespace std;typedef long long ll;ll reduce(ll x,const vector<pair<ll,ll>>&q){    ll cnt=0;    ll i=0;    ll j=q.size();    while (x>0)    {        pair<ll,ll>p=q[i%j];        if(p.first==2){            while (x>0 && p.second)            {               x/=2;               cnt++;               p.second--;            }        }        else{            ll k=min(x,p.second);            x-=k;            cnt+=k;        }        if(x<=0)break;        i++;    }    return cnt;}void solve(){    ll n,m;    cin>>n>>m;    string s;    cin>>s;    bool flag=1;    for(char c:s)if(c=='B')flag=0;    // we have to compress this string into blocks of type A and type B            vector<ll>queries(m);    for (ll i = 0; i < m; i++)cin>>queries[i];    vector<ll>ans;    for (ll i = 0; i < m; i++)    {        ll x=queries[i];        if(flag)cout<<x<<'\n';        else{            ll k=0,idx=0;            while (x)            {               k++;                if(s[idx]=='A')x--;               else x>>=1;               idx++;               idx%=n;            }            cout<<k<<'\n';        }    } } int main(){ll t;cin>>t;while (t--){    solve();}     return 0;}